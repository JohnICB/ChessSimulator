set serveroutput on;
DECLARE
      c_zi_nastere CONSTANT VARCHAR2(30) := '30-01-2000';
      v_current_day DATE;
      v_months_between INTEGER;
      v_days_difference v_months_between%TYPE;
      v_day_of_the_week VARCHAR2(20);
      v_day_of_the_week_ro v_day_of_the_week%TYPE;
      
BEGIN
      select current_date into v_current_day from dual;
      DBMS_OUTPUT.PUT_LINE('Data curenta: ' || v_current_day);
      DBMS_OUTPUT.PUT_LINE('Data nastere: ' || TO_DATE(c_zi_nastere,'dd-mm-yyyy'));
      
      v_day_of_the_week := TO_CHAR(TO_DATE(c_zi_nastere,'dd-mm-yyyy'),'day');
      v_day_of_the_week_ro := TO_CHAR(TO_DATE(c_zi_nastere,'dd-mm-yyyy'),'day','nls_date_language=romanian');
      select months_between(v_current_day,TO_DATE(c_zi_nastere,'dd-mm-yyyy')) into v_months_between from dual;
      
      IF(extract(day from v_current_day)>=extract(day from TO_DATE(c_zi_nastere,'dd-mm-yyyy')))
        THEN
            v_days_difference := extract(day from v_current_day)-extract(day from TO_DATE(c_zi_nastere,'dd-mm-yyyy'))+1;
            v_months_between:=v_months_between-1;
        ELSE
            v_days_difference := extract(day from v_current_day) + (extract(day from last_day(to_date(c_zi_nastere,'dd-mm-yyyy')-30))- extract(day from TO_DATE(c_zi_nastere,'dd-mm-yyyy')))+1;      
      END IF;
      
      DBMS_OUTPUT.PUT_LINE(v_days_difference || ' zile si ' || v_months_between || ' luni si ziua saptamanii este ' || trim(v_day_of_the_week)||'/'||trim(v_day_of_the_week_ro));
      
END;



CREATE OR REPLACE TRIGGER insert_literatura
  INSTEAD OF insert ON literatura
BEGIN
  dbms_output.put_line('Adaugam ceva:'||:NEW.TITLU || :NEW.EDITURA || :NEW.NUME || :NEW.EMAIL);
  
  insert into carti values (:NEW.EDITURA,:NEW.TITLU);
  insert into autori values (:NEW.NUME,:NEW.EMAIL,:NEW.TITLU);
END;
select * from literatura;
set serveroutput on;
begin
insert into literatura values('TESTPSGBD','TESTPSSBGBD','Creanga','asd@yahoo.com');
insert into literatura values('Edit9','Text9','Creanga','asd@yahoo.com');
insert into literatura values('Edit10','Text10','Creanga','asd@yahoo.com');
insert into literatura values('Edit11','Text11','Creanga','asd@yahoo.com');
insert into literatura values('Edit12','Text12','Creanga','asd@yahoo.com');
insert into literatura values('Edit13','Text13','Creanga','asd@yahoo.com');
insert into literatura values('Edit14','Text14','Creanga','asd@yahoo.com');
insert into literatura values('Edit15','Text15','Creanga','asd@yahoo.com');
end;

select * from autori;

CREATE OR REPLACE TRIGGER delete_literatura
  INSTEAD OF delete ON literatura
BEGIN
   dbms_output.put_line('Stergem:' || :NEW.titlu);
   delete from carti where TITLU = :NEW.titlu;
   delete from autori where TITLU = :NEW.titlu;
END;


delete from literatura where NUME='Creanga';

select * from carti;

CREATE OR REPLACE TRIGGER update_literatura
  INSTEAD OF UPDATE ON literatura
BEGIN
   dbms_output.put_line('Update:' || :OLD.email || ' - '|| :NEW.email);
   update autori set email = :NEW.email;
END;

select * from literatura;
UPDATE literatura SET email = 'PSGBD@yahoo.com' WHERE nume = 'Creanga';
select * from literatura;